# Form model

[![Build Status](https://travis-ci.org/web-complete/form.svg?branch=master)](https://travis-ci.org/web-complete/form)
[![Coverage Status](https://coveralls.io/repos/github/web-complete/form/badge.svg?branch=master)](https://coveralls.io/github/web-complete/form?branch=master)

Простая, но очень гибкая модель для фильтрации и валидации данных на стороне сервера, созданная по мотивам Yii Forms.

Библиотека не имеет зависимостей и может быть легко использована в любом фреймворке.

## Usage

Для использования формы необходимо создать класс, унаследованный от AbstractForm и реализовать два абстрактных метода: rules() и filters(). В примитивном случае, они могут возвращать пустые массивы.

**Filters** (правила фильтрации) представляет из себя массив следующего формата:
```
[
    [field, filter, params]
]
```
где:

**field** - название поля (ключ массива данных)<br>
**filter** - название фильтра. Может быть строкой, либо callable. В случае, если передана строка, то форма проверит наличие одноименного метода в порядке приоритета: в собственном объекте, в объекте фильтров (filtersObject). Фильтр будет вызван с параметрами: $value (значение), $params (параметры из правила), $form (текущий объект формы) и должен вернуть отфильтрованное значение.
**params** - массив параметров, будет передан в фильтр. Обязательность зависит от вызываемого фильтра. 

**Rules** (правила валидации) представляет из себя массив следующего формата:
```
[
    [field, validator, params, message]
]
```
где:

**field** - название поля (ключ массива данных)<br>
**validator** - название валидатора. Может быть строкой, либо callable. В случае, если передана строка, то форма проверит наличие одноименного метода в порядке приоритета: в собственном объекте, в объекте валидаций (validatorsObject). Валидатор будет вызван с параметрами: $value (значение) и $params (параметры из правила) и должен вернуть булево значение.
**params** - массив параметров, будет передан в фильтр. Обязательность зависит от вызываемого фильтра. 
**message** - массив параметров, будет передан в фильтр. Обязательность зависит от вызываемого фильтра.
 
Форма имеет один встроенный валидатор **required**, который проверяет что данное поле не пустое. Остальные валидаторы будут применены только к непустым полям.

В конструктор класса могут быть переданы параметры:
```
    public function __construct(
        $rules = null,
        $filters = null,
        $validatorsObject = null,
        $filtersObject = null
    )
```

**rules** - массив правил, будет добавлен к правилам **rules()** (необязательный)<br>
**filters** - массив правил, будет добавлен к правилам **filters()** (необязательный)<br>
**validatorsObject** - объект, содержащий методы валидации (необязательный)<br>
**filtersObject** - объект, содержащий методы фильтрации (необязательный)<br>

В комплекте библиотеки в качестве **validatorsObject** и **filtersObject** поставляются два класса: Validators, Filters, содержащие наиболее часто используемые наборы фильтров и валидаторов. 

## Filters
Фильтры, поставляемые в комплекте с библиотекой (могут быть использованы самостоятельно):

**trim** - обрезание пробелов по краям (Возможные параметры: charlist, left, right)<br>
**escape**  - htmlspecialchars<br>
**capitalize** - перевод значение в нижний регистр + заглавная буква<br>
**lowercase** - перевод значение в нижний регистр <br>
**uppercase** - перевод значение в верхний регистр <br>
**replace** - замена подстроки (Возможные параметры: pattern (строка или регулярное выражение), to)<br>
**stripTags** - вырезание html-тегов <br>
**stripJs** - вырезание js <br>

Для более подробной информации см. аннотации в классе Filters

## Validators
Валидаторы, поставляемые в комплекте с библиотекой (могут быть использованы самостоятельно):

**equals** - сравнение с другим значением (Параметры: value, not (проверяет неравенство, если true))<br>
**compare** - сравнение с другим полем формы (Параметры: field (третьим аргументом ожидает объект формы), not (проверяет неравенство, если true))<br>
**email** - e-mail <br>
**number** - числовое значение (Возможные параметры: min, max) <br>
**string** - строка (Возможные параметры: min, max - длина строки) <br>
**regex** - регулярное выражение (Параметры: pattern) <br>

## Examples